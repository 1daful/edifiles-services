"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _dateformat = _interopRequireDefault(require("dateformat"));

var _chalk = _interopRequireDefault(require("chalk"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

class StringBuilder {
  constructor(config) {
    _defineProperty(this, "config", void 0);

    _defineProperty(this, "printQueue", void 0);

    _defineProperty(this, "filteredHeaderList", void 0);

    this.config = config;
    this.printQueue = [];
    this.filteredHeaderList = ['common', 'delete', 'get', 'head', 'post', 'put', 'patch', 'content-type', 'content-length', 'vary', 'date', 'connection', 'content-security-policy'];
  }

  makeLogTypeWithPrefix(logType) {
    const prefix = this.config.prefixText === false ? `[${logType}]` : `[${this.config.prefixText || 'Axios'}][${logType}]`;
    this.printQueue.push(_chalk.default.green(prefix));
    return this;
  }

  makeDateFormat(date) {
    // allow for opting-out of adding the timestamp (as most loggers already add this)
    if (this.config.dateFormat !== false) {
      // @ts-ignore
      const dateFormat = (0, _dateformat.default)(date, this.config.dateFormat || 'isoDateTime');
      this.printQueue.push(dateFormat);
    }

    return this;
  }

  makeHeader(headers) {
    if (this.config.headers && headers) {
      const headerMap = {};

      for (let key in headers) {
        if (!this.filteredHeaderList.includes(key)) {
          headerMap[key] = headers[key];
        }
      }

      this.printQueue.push(JSON.stringify(headerMap));
    }

    return this;
  }

  makeUrl(url, baseUrl) {
    if (this.config.url && url) {
      if (baseUrl) url = this.combineURLs(baseUrl, url);
      this.printQueue.push(url);
    }

    return this;
  }

  makeParams(params) {
    if (this.config.params && params) this.printQueue.push(JSON.stringify(params));
    return this;
  }

  makeMethod(method) {
    if (this.config.method && method) this.printQueue.push(_chalk.default.yellow(method.toUpperCase()));
    return this;
  }

  makeData(data) {
    if (this.config.data && data) {
      const str = typeof data === `string` ? data : JSON.stringify(data);
      this.printQueue.push(str);
    }

    return this;
  }

  makeStatus(status, statusText) {
    if (this.config.status && this.config.statusText && status && statusText) this.printQueue.push(`${status}:${statusText}`);else if (this.config.status && status) this.printQueue.push(`${status}`);else if (this.config.statusText && statusText) this.printQueue.push(statusText);
    return this;
  }

  build() {
    return this.printQueue.join(' ');
  }
  /**
   * Helper imported from Axios library
   * @see https://github.com/axios/axios/blob/d99d5faac29899eba68ce671e6b3cbc9832e9ad8/lib/helpers/combineURLs.js
   * */


  combineURLs(baseURL, relativeURL) {
    return relativeURL ? baseURL.replace(/\/+$/, '') + '/' + relativeURL.replace(/^\/+/, '') : baseURL;
  }

}

var _default = StringBuilder;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb21tb24vc3RyaW5nLWJ1aWxkZXIudHMiXSwibmFtZXMiOlsiU3RyaW5nQnVpbGRlciIsImNvbnN0cnVjdG9yIiwiY29uZmlnIiwicHJpbnRRdWV1ZSIsImZpbHRlcmVkSGVhZGVyTGlzdCIsIm1ha2VMb2dUeXBlV2l0aFByZWZpeCIsImxvZ1R5cGUiLCJwcmVmaXgiLCJwcmVmaXhUZXh0IiwicHVzaCIsImNoYWxrIiwiZ3JlZW4iLCJtYWtlRGF0ZUZvcm1hdCIsImRhdGUiLCJkYXRlRm9ybWF0IiwibWFrZUhlYWRlciIsImhlYWRlcnMiLCJoZWFkZXJNYXAiLCJrZXkiLCJpbmNsdWRlcyIsIkpTT04iLCJzdHJpbmdpZnkiLCJtYWtlVXJsIiwidXJsIiwiYmFzZVVybCIsImNvbWJpbmVVUkxzIiwibWFrZVBhcmFtcyIsInBhcmFtcyIsIm1ha2VNZXRob2QiLCJtZXRob2QiLCJ5ZWxsb3ciLCJ0b1VwcGVyQ2FzZSIsIm1ha2VEYXRhIiwiZGF0YSIsInN0ciIsIm1ha2VTdGF0dXMiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiYnVpbGQiLCJqb2luIiwiYmFzZVVSTCIsInJlbGF0aXZlVVJMIiwicmVwbGFjZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUVBOzs7Ozs7QUFFQSxNQUFNQSxhQUFOLENBQW9CO0FBS2hCQyxFQUFBQSxXQUFXLENBQUNDLE1BQUQsRUFBMEI7QUFBQTs7QUFBQTs7QUFBQTs7QUFDakMsU0FBS0EsTUFBTCxHQUFjQSxNQUFkO0FBQ0EsU0FBS0MsVUFBTCxHQUFrQixFQUFsQjtBQUNBLFNBQUtDLGtCQUFMLEdBQTBCLENBQUMsUUFBRCxFQUFXLFFBQVgsRUFBcUIsS0FBckIsRUFBNEIsTUFBNUIsRUFBb0MsTUFBcEMsRUFBNEMsS0FBNUMsRUFBbUQsT0FBbkQsRUFBNEQsY0FBNUQsRUFBNEUsZ0JBQTVFLEVBQThGLE1BQTlGLEVBQXNHLE1BQXRHLEVBQThHLFlBQTlHLEVBQTRILHlCQUE1SCxDQUExQjtBQUNI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QXVDO0FBQzdDLFFBQUcsS0FBS25DLE1BQUwsQ0FBWWtDLE1BQVosSUFBc0IsS0FBS2xDLE1BQUwsQ0FBWW1DLFVBQWxDLElBQWdERCxNQUFoRCxJQUEwREMsVUFBN0QsRUFBeUUsS0FBS2xDLFVBQUwsQ0FBZ0JNLElBQWhCLENBQXNCLEdBQUUyQixNQUFPLElBQUdDLFVBQVcsRUFBN0MsRUFBekUsS0FDSyxJQUFHLEtBQUtuQyxNQUFMLENBQVlrQyxNQUFaLElBQXNCQSxNQUF6QixFQUFpQyxLQUFLakMsVUFBTCxDQUFnQk0sSUFBaEIsQ0FBc0IsR0FBRTJCLE1BQU8sRUFBL0IsRUFBakMsS0FDQSxJQUFHLEtBQUtsQyxNQUFMLENBQVltQyxVQUFaLElBQTBCQSxVQUE3QixFQUF5QyxLQUFLbEMsVUFBTCxDQUFnQk0sSUFBaEIsQ0FBcUI0QixVQUFyQjtBQUM5QyxXQUFPLElBQVA7QUFDSDs7QUFFREMsRUFBQUEsS0FBSyxHQUFHO0FBQ0osV0FBTyxLQUFLbkMsVUFBTCxDQUFnQm9DLElBQWhCLENBQXFCLEdBQXJCLENBQVA7QUFDSDtBQUVEO0FBQ0o7QUFDQTtBQUNBOzs7QUFDSWQsRUFBQUEsV0FBVyxDQUFDZSxPQUFELEVBQWtCQyxXQUFsQixFQUFnRDtBQUN2RCxXQUFPQSxXQUFXLEdBQ1pELE9BQU8sQ0FBQ0UsT0FBUixDQUFnQixNQUFoQixFQUF3QixFQUF4QixJQUE4QixHQUE5QixHQUFvQ0QsV0FBVyxDQUFDQyxPQUFaLENBQW9CLE1BQXBCLEVBQTRCLEVBQTVCLENBRHhCLEdBRVpGLE9BRk47QUFHSDs7QUF0RmU7O2VBeUZMeEMsYSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkYXRlZm9ybWF0IGZyb20gJ2RhdGVmb3JtYXQnO1xuaW1wb3J0IHsgR2xvYmFsTG9nQ29uZmlnIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgY2hhbGsgZnJvbSAnY2hhbGsnO1xuXG5jbGFzcyBTdHJpbmdCdWlsZGVyIHtcbiAgICBwcml2YXRlIGNvbmZpZzogR2xvYmFsTG9nQ29uZmlnO1xuICAgIHByaXZhdGUgcHJpbnRRdWV1ZTogQXJyYXk8c3RyaW5nPjtcbiAgICBwcml2YXRlIGZpbHRlcmVkSGVhZGVyTGlzdDogQXJyYXk8U3RyaW5nPjtcblxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZzogR2xvYmFsTG9nQ29uZmlnKSB7XG4gICAgICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgICAgICB0aGlzLnByaW50UXVldWUgPSBbXTtcbiAgICAgICAgdGhpcy5maWx0ZXJlZEhlYWRlckxpc3QgPSBbJ2NvbW1vbicsICdkZWxldGUnLCAnZ2V0JywgJ2hlYWQnLCAncG9zdCcsICdwdXQnLCAncGF0Y2gnLCAnY29udGVudC10eXBlJywgJ2NvbnRlbnQtbGVuZ3RoJywgJ3ZhcnknLCAnZGF0ZScsICdjb25uZWN0aW9uJywgJ2NvbnRlbnQtc2VjdXJpdHktcG9saWN5J107XG4gICAgfVxuXG4gICAgbWFrZUxvZ1R5cGVXaXRoUHJlZml4KGxvZ1R5cGU6IHN0cmluZykge1xuICAgICAgICBjb25zdCBwcmVmaXggPSB0aGlzLmNvbmZpZy5wcmVmaXhUZXh0ID09PSBmYWxzZSA/IGBbJHtsb2dUeXBlfV1gIDogYFske3RoaXMuY29uZmlnLnByZWZpeFRleHQgfHwgJ0F4aW9zJ31dWyR7bG9nVHlwZX1dYDtcbiAgICAgICAgdGhpcy5wcmludFF1ZXVlLnB1c2goY2hhbGsuZ3JlZW4ocHJlZml4KSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIG1ha2VEYXRlRm9ybWF0KGRhdGU6IERhdGUpIHtcbiAgICAgICAgLy8gYWxsb3cgZm9yIG9wdGluZy1vdXQgb2YgYWRkaW5nIHRoZSB0aW1lc3RhbXAgKGFzIG1vc3QgbG9nZ2VycyBhbHJlYWR5IGFkZCB0aGlzKVxuICAgICAgICBpZiAodGhpcy5jb25maWcuZGF0ZUZvcm1hdCAhPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGNvbnN0IGRhdGVGb3JtYXQgPSBkYXRlZm9ybWF0KGRhdGUsIHRoaXMuY29uZmlnLmRhdGVGb3JtYXQgfHwgJ2lzb0RhdGVUaW1lJyk7XG4gICAgICAgICAgICB0aGlzLnByaW50UXVldWUucHVzaChkYXRlRm9ybWF0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBtYWtlSGVhZGVyKGhlYWRlcnM/OiB7IFtrZXk6c3RyaW5nXSA6IHt2YWx1ZTpzdHJpbmd9fSkge1xuICAgICAgICBpZih0aGlzLmNvbmZpZy5oZWFkZXJzICYmIGhlYWRlcnMpIHtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlck1hcDp7IFtrZXk6c3RyaW5nXSA6IHt2YWx1ZTpzdHJpbmd9fSA9IHt9O1xuICAgICAgICAgICAgZm9yKGxldCBrZXkgaW4gaGVhZGVycykge1xuICAgICAgICAgICAgICAgIGlmKCF0aGlzLmZpbHRlcmVkSGVhZGVyTGlzdC5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlck1hcFtrZXldID0gaGVhZGVyc1trZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5wcmludFF1ZXVlLnB1c2goSlNPTi5zdHJpbmdpZnkoaGVhZGVyTWFwKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgbWFrZVVybCh1cmw/OiBzdHJpbmcsIGJhc2VVcmw/OiBzdHJpbmcpIHtcbiAgICAgICAgaWYodGhpcy5jb25maWcudXJsICYmIHVybCkge1xuICAgICAgICAgICAgaWYoYmFzZVVybCkgdXJsID0gdGhpcy5jb21iaW5lVVJMcyhiYXNlVXJsLCB1cmwpO1xuICAgICAgICAgICAgdGhpcy5wcmludFF1ZXVlLnB1c2godXJsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBtYWtlUGFyYW1zKHBhcmFtcz86IG9iamVjdCkge1xuICAgICAgICBpZih0aGlzLmNvbmZpZy5wYXJhbXMgJiYgcGFyYW1zKSB0aGlzLnByaW50UXVldWUucHVzaChKU09OLnN0cmluZ2lmeShwYXJhbXMpKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgbWFrZU1ldGhvZChtZXRob2Q/OiBzdHJpbmcpIHtcbiAgICAgICAgaWYodGhpcy5jb25maWcubWV0aG9kICYmIG1ldGhvZCkgdGhpcy5wcmludFF1ZXVlLnB1c2goY2hhbGsueWVsbG93KG1ldGhvZC50b1VwcGVyQ2FzZSgpKSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIG1ha2VEYXRhKGRhdGE6IG9iamVjdCkge1xuICAgICAgICBpZih0aGlzLmNvbmZpZy5kYXRhICYmIGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnN0IHN0ciA9IHR5cGVvZiBkYXRhID09PSBgc3RyaW5nYCA/IGRhdGEgOiBKU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICAgICAgICAgIHRoaXMucHJpbnRRdWV1ZS5wdXNoKHN0cik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgbWFrZVN0YXR1cyhzdGF0dXM/OiBudW1iZXIsIHN0YXR1c1RleHQ/OiBzdHJpbmcpIHtcbiAgICAgICAgaWYodGhpcy5jb25maWcuc3RhdHVzICYmIHRoaXMuY29uZmlnLnN0YXR1c1RleHQgJiYgc3RhdHVzICYmIHN0YXR1c1RleHQpIHRoaXMucHJpbnRRdWV1ZS5wdXNoKGAke3N0YXR1c306JHtzdGF0dXNUZXh0fWApO1xuICAgICAgICBlbHNlIGlmKHRoaXMuY29uZmlnLnN0YXR1cyAmJiBzdGF0dXMpIHRoaXMucHJpbnRRdWV1ZS5wdXNoKGAke3N0YXR1c31gKTtcbiAgICAgICAgZWxzZSBpZih0aGlzLmNvbmZpZy5zdGF0dXNUZXh0ICYmIHN0YXR1c1RleHQpIHRoaXMucHJpbnRRdWV1ZS5wdXNoKHN0YXR1c1RleHQpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBidWlsZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJpbnRRdWV1ZS5qb2luKCcgJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSGVscGVyIGltcG9ydGVkIGZyb20gQXhpb3MgbGlicmFyeVxuICAgICAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2F4aW9zL2F4aW9zL2Jsb2IvZDk5ZDVmYWFjMjk4OTllYmE2OGNlNjcxZTZiM2NiYzk4MzJlOWFkOC9saWIvaGVscGVycy9jb21iaW5lVVJMcy5qc1xuICAgICAqICovXG4gICAgY29tYmluZVVSTHMoYmFzZVVSTDogc3RyaW5nLCByZWxhdGl2ZVVSTD86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiByZWxhdGl2ZVVSTFxuICAgICAgICAgICAgPyBiYXNlVVJMLnJlcGxhY2UoL1xcLyskLywgJycpICsgJy8nICsgcmVsYXRpdmVVUkwucmVwbGFjZSgvXlxcLysvLCAnJylcbiAgICAgICAgICAgIDogYmFzZVVSTDtcbiAgICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBTdHJpbmdCdWlsZGVyO1xuIl19